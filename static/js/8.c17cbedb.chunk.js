(this.webpackJsonpthinkythreads=this.webpackJsonpthinkythreads||[]).push([[8],{385:function(e,t,o){"use strict";o.r(t);var n=o(6),r=o(1),c=o(349),a=o.n(c),i=(o(366),o(4)),s=o(346),l=o(77),d=o(337),u=o(24),b=o(345),h=o(121),m=o(9),p=function(e){var t=e.selectedNote,o=e.open,n=e.setOpen,r=e.saveAndExit,c=e.exportThread,a=e.threadCollectionSwap,i=e.openOccurrences,s=e.moveToTheExtremity;return Object(m.jsx)(h.a,{trigger:Object(m.jsx)("div",{children:Object(m.jsx)(b.a,{className:"tools-btn",size:"1.5em",onClick:function(){return n(!0)}})}),nested:!0,modal:!0,open:o,children:Object(m.jsx)("div",{className:"blurrer",onClick:function(){return n(!1)},children:Object(m.jsxs)("div",{className:"modal menu-popup",children:[Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){i(),r()},children:"Show Threads or Collections that contain this Note"}),Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){s(!0),r(!0)},children:"Save and move to the end of the Search"}),Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){s(),r(!0)},children:"Save and move to the beginning of the Search"}),t.thread.length?Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){return c()},children:"Print or Export whole Thread"}),Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){return a(!0)},children:"Convert Thread to Collection"})]}):t.collection.length?Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"popup-btn tools-btn",onClick:function(){return a(!1)},children:"Convert Collection to Thread"})}):null]})})})},f=o(5),j=o(18),g=o(138),O=function(e){var t=e.setCurrentPage,o=e.selectedNote,c=e.updateNote,a=e.editorState,b=e.deleteNote,h=e.darkMode,O=e.exportThread,v=e.setBackColor,x=e.threadCollectionSwap,k=e.moveToTheExtremity,C=e.dashboard,N=e.openOccurrences,y=e.packDashboard,S=e.editorRef;Object(r.useEffect)((function(){if(S&&S.current&&S.current.editor){var e=S.current.editor.keyboard.bindings[83];e&&e.pop(),S.current.editor.keyboard.addBinding({key:"s",shortKey:!0,handler:function(){return a.replace(/<[^>]*>?/gm,"")&&F()}})}}),[S,a]);var w="";o&&(w=o.pinned);var T=Object(r.useState)(w),E=Object(n.a)(T,2),z=E[0],D=E[1],P=Object(r.useState)(!1),B=Object(n.a)(P,2),R=B[0],I=B[1],q=Object(r.useState)(!1),M=Object(n.a)(q,2),A=M[0],Q=M[1],V=function(){Q(!0),o.pinned=!o.pinned,D(o.pinned)},F=function(e){if(j.c.closingEditor=!0,o.text===a&&!A&&""!==a&&!e)return t("notes"),Object(f.e)(o),Object(f.f)(C),void y(Object(i.a)({},C));o.text=a,Object(f.o)(o),"empty note kept for its links"!==o.preview||o.thread.length||o.collection.length||o.branches.length||o.attachedImg?(c(o),t("notes")):(b(o.id),t("notes"))};return g.bind(["ctrl+s","meta+s"],(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,a.replace(/<img .*?>/gm,"0").replace(/<[^>]*>?/gm,"")&&F()})),Object(m.jsx)("div",{children:Object(m.jsxs)("div",{className:"page-footer",style:{color:h?"#636363":"#171717"},children:[Object(m.jsx)(d.a,{className:"tools-btn",onClick:function(){return F()},size:"2.5em"}),z?Object(m.jsx)(s.a,{className:"tools-btn",onClick:function(){return V()},size:"1.75em",style:{transform:"rotate(-45deg)"}}):Object(m.jsx)(s.e,{className:"tools-btn",onClick:function(){return V()},size:"1.75em"}),Object(m.jsx)(u.a,{selectedNote:o,setBackColor:v,setHasChanged:Q}),Object(m.jsx)(l.f,{className:"tools-btn",onClick:function(){window.confirm("Delete the note?")&&(b(o.id),t("notes"))},size:"1.65em"}),Object(m.jsx)(p,{selectedNote:o,open:R,setOpen:I,saveAndExit:F,exportThread:O,threadCollectionSwap:x,openOccurrences:N,moveToTheExtremity:k})]})})},v=o(367),x=o.n(v),k=o(368),C=o.n(k),N=o(14),y=o(12);c.Quill.register("modules/imageCompressor",x.a),c.Quill.register("modules/imageResize",C.a);var S={toolbar:[{header:"1"},{header:"2"},"bold","italic","underline","strike",{list:"ordered"},{list:"bullet"},{align:[]},{color:[]},{background:[]},"image","code-block","formula","blockquote","link"],imageCompressor:{maxWidth:800,maxHeight:800,imageType:"image/jpeg",debug:!1},history:{delay:2e3,maxStack:500,userOnly:!0},clipboard:{matchVisual:!1},imageResize:{parchment:c.Quill.import("parchment"),modules:["Resize","DisplaySize"]}},w=function(e,t,o,n){if(o.current){var r=o.current.editor;!function(e,t){var o=e.ops,n=t.getSelection();if(n){var r=n.index,c=n.length;if(void 0===o[0].retain||!o[1]||!o[1].insert||!o[1].insert||"\n"!==o[1].insert||c>0)return;setTimeout((function(){t.getSelection().index===r&&(console.log("Change selection bad pos"),t.setSelection(t.getSelection().index+1,0))}),30)}}(t,r),e.length<j.e?(n(e),r.getLength()===t.ops[0].retain+2&&document.getElementsByClassName("ql-editor")[0].scrollIntoView({block:"end"})):Object(y.b)(N.c)}};t.default=function(e){var t=e.setCurrentPage,o=e.dashboard,c=e.updateNote,i=e.deleteNote,s=e.darkMode,l=e.exportThread,d=e.threadCollectionSwap,u=e.moveToTheExtremity,b=e.openOccurrences,h=e.packDashboard,p=e.setDelayedNoteUpdate,g=o.notes.get(o.selectedNoteId),v="",x={color:"",colorPreview:""};g&&g.text&&(v=g.text,x.color=g.color,x.colorPreview=g.colorPreview);var k=Object(r.useState)(v),C=Object(n.a)(k,2),N=C[0],y=C[1],T=Object(r.useState)(x),E=Object(n.a)(T,2),z=E[0],D=E[1],P=Object(r.useState)(!0),B=Object(n.a)(P,2),R=B[0],I=B[1],q=Object(r.useRef)(null),M=function(){var e=Object(r.useRef)(!1);return Object(r.useEffect)((function(){return e.current=!0,function(){return e.current=!1}}),[]),e}();return Object(r.useEffect)((function(){N&&g&&g.text!==N&&(I(!1),p({note:g,delay:2e3,metaOrMedia:"media",callbackFunction:function(){M.current&&I(!0)},beforeFunction:function(){g.text=N,Object(f.o)(g)}}))}),[N]),Object(r.useEffect)((function(){if(q&&!N&&q.current.editor.focus(),j.c.ios){var e=document.getElementsByClassName("ql-editor")[0];e&&(e.style.fontSize="15px")}}),[]),Object(r.useEffect)((function(){var e=document.getElementsByClassName("ql-toolbar")[0];if(e){var t=s?"#ffffff"!==z.color?{backgroundImage:"linear-gradient(20deg, #171717 90%, "+(z.colorPreview||"#171717")+" 90%)",color:"white"}:{backgroundColor:"#171717",color:"white"}:{backgroundColor:z.color||"#ffffff"};e.style.backgroundImage=t.backgroundImage,e.style.color=t.color,e.style.backgroundColor=t.backgroundColor}}),[z]),Object(m.jsxs)("div",{className:"container",style:s?{backgroundColor:"#171717",color:"white"}:{backgroundColor:z.color},children:[Object(m.jsx)("div",{className:"editor no-scrollbar",id:"editor",children:Object(m.jsx)(a.a,{style:{zoom:1.4},theme:"snow",value:N,onChange:function(e,t){w(e,t,q,y)},modules:S,placeholder:"Write your next idea here...",ref:q,scrollingContainer:"#editor"})}),Object(m.jsx)("div",{className:"saved-changes",children:R?"All changes have been saved":"Unsaved changes..."}),Object(m.jsx)(O,{setCurrentPage:t,selectedNote:g,updateNote:c,editorState:N,deleteNote:i,darkMode:s,exportThread:l,setBackColor:D,threadCollectionSwap:d,moveToTheExtremity:u,dashboard:o,openOccurrences:b,packDashboard:h,editorRef:q})]})}}}]);
//# sourceMappingURL=8.c17cbedb.chunk.js.map